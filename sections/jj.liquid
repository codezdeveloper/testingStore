{{ 'https://unpkg.com/swiper/swiper-bundle.min.css' | stylesheet_tag }}

<style>

  .swiper-slide {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
    font-size: 10vw;
    text-align: center;
    color: #fff;
    transition: 0.5s all;
  }
  
  .swiper-pagination {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .swiper-pagination-bullet {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    width: auto;
    height: auto;
    margin: 0 10px;
    background-color: transparent;
    border-radius: 50%;
    cursor: pointer;
    transition: 0.3s;
  }
  
  .swiper-pagination-bullet span {
    color: #fff;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  
/*   .progress {
    transform: rotate(0deg);
  } */

  .square-origin {
    fill: transparent;
    stroke: rgb(255, 255, 255);
    stroke-width: 5;
    stroke-linecap: round;
    stroke-dasharray: 200px;
    stroke-dashoffset: 200px;
  }
  
  .swiper-pagination-bullet-active .square-origin {
    animation: progress 5s;
  }
  
  @keyframes progress {
    0% {
      stroke-dashoffset: 200px;
    }
  
    100% {
      stroke-dashoffset: 0px;
    }
  }
  
</style>

<div class="main-{{ section.id }}">

  <!-- Slider main container -->
  <div class="swiper">
    <!-- Additional required wrapper -->
    <div class="swiper-wrapper">
      <!-- Slides -->
      {% for block in section.blocks %}
        <div class="swiper-slide">
          <img src="{{ block.settings.slide_image | img_url: 'master' }}">
        </div>
      {% endfor %}
    </div>
    <!-- If we need pagination -->
<!--     <div class="swiper-pagination"></div> -->
  
    <!-- If we need navigation buttons -->
<!--     <div class="swiper-button-prev"></div> -->
    <div class="swiper-button-next">Next</div>
  
    <!-- If we need scrollbar -->
<!--     <div class="swiper-scrollbar"></div> -->
  </div>
    
</div>

{{ 'https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.2.2/swiper-bundle.min.js' | script_tag }}

<script>

  const slide = document.querySelectorAll(".swiper-slide");
  // for (const i of slide) {
  //   const random = (number) => Math.floor(Math.random() * (number + 1));
  //   const rndCol = `rgb(${random(255)},${random(255)},${random(255)})`;
  //   i.style.backgroundColor = rndCol;
  // }
  const swiperOptions = {
    loop: "infinite",
    effect: "fade",
    // autoplay: {
    //   delay: 5000,
    //   disableOnInteraction: false
    // },
    navigation: {
      nextEl: ".swiper-button-next",
      // prevEl: ".swiper-button-prev"
    },
    // custom pagination
    // pagination: {
    //   el: ".swiper-pagination",
    //   clickable: true,
    //   renderBullet: function (i, className) {
        
    //     let getSlideImage = document.querySelector(`.swiper-slide-next img`).src;
    //     console.log(i, getSlideImage, i + 1);
    //     return `<button class="${className}"><svg class="progress" width="50" height="50"><rect class="square-origin" width="50" height="50"></rect></svg><span><img src="${getSlideImage}" width="45" height="45"></span></button>`;
    //   }
    // }
  };
  
  const swiper = new Swiper(".swiper", swiperOptions);

  swiper.on('slideChangeTransitionEnd', function (e) {
      console.log('*** mySwiper.activeIndex', e);
    let getSlideImage = swiper.el.querySelector(`.swiper-slide-next img`).src;
    console.log(getSlideImage)
    // let imgEL = document.createElement("img");
    // imgEL.src= getSlideImage
    document.querySelector(".swiper-button-next").innerHTML = `<img src="${ getSlideImage }" width="100" height="100" />`
  });
  
</script>

{% schema %}
  {
    "name": "JJ",
    "settings": [],
    "blocks": [
      {
        "name": "Main Animated Slider",
        "type": "main-animated-slider",
        "settings": [
          {
            "type": "image_picker",
            "id": "slide_image",
            "label": "Slide Image"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "JJ"
      }
    ]
  }
{% endschema %}